<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Персонажи — Kazan & Dragons</title>
  <link rel="stylesheet" href="style.css">
  <!-- НЕ подключаем character-sheet.css! -->
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="logo-sidebar">
      <div class="logo-icon"></div>
      <span>KAZAN & DRAGONS</span>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Главная</a></li>
      <li><a href="parties.html">Набор в партии</a></li>
      <li><a href="rules.html">Правила D&D</a></li>
      <li><a href="#" class="active">Персонажи</a></li>
      <li><a href="tabletop.html">Игровое поле</a></li>
      <li><a href="tokenator.html">Токенатор</a></li>
    </ul>
  </aside>

  <!-- Main Content -->
  <div class="main-content" id="mainContent">
    <header>
      <button class="menu-toggle" id="menuToggle">☰</button>
      <div class="account-widget">
        <div class="account-info" id="accountInfo">
          <div class="account-name" id="accountName">—</div>
          <div class="account-role" id="accountRole">—</div>
        </div>
        <button class="auth-btn" id="authButton">Войти / Регистрация</button>
      </div>
    </header>

    <div class="page-header">
      <h1>Хранилище персонажей</h1>
      <p>Создавайте и управляйте своими героями</p>
    </div>

    <div class="controls">
      <button class="new-char-btn" id="newCharBtn">+ Новый персонаж</button>
    </div>

    <!-- Сетка существующих персонажей -->
    <div class="characters-grid" id="charactersGrid">
      <!-- Персонажи будут отображаться здесь -->
    </div>

    <footer>
      <p>© 2025 Kazan & Dragons (K&D)</p>
    </footer>
  </div>

  <!-- Редактор персонажа (скрыт по умолчанию) -->
  <div class="character-editor" id="characterEditor">
    <div style="max-width: 1400px; margin: 0 auto;">
      <div class="editor-header">
        <h2 id="editorTitle">Создание персонажа</h2>
        <button class="btn btn-secondary" id="closeEditor">✕ Закрыть</button>
      </div>

      <!-- Кнопки управления в редакторе -->
      <div class="controls" style="background: transparent; padding: 0 0 1rem 0;">
        <button class="btn btn-primary" id="saveCharBtn">Сохранить персонажа</button>
        <button class="btn export-btn" id="exportJsonBtn">Экспорт в JSON</button>
      </div>

      <div class="character-sheet">
        <!-- ВЕРХНЯЯ ЧАСТЬ - ОСНОВНАЯ ИНФОРМАЦИЯ -->
        <div class="character-header">
          <div class="form-group">
            <label>Имя персонажа</label>
            <input type="text" id="charName" class="form-control" placeholder="Арагорн">
          </div>
          <div class="form-group">
            <label>Предыстория</label>
            <input type="text" id="charBackground" class="form-control" placeholder="Странник">
          </div>
          <div class="form-group">
            <label>Класс</label>
            <input type="text" id="charClass" class="form-control" placeholder="Воин">
          </div>
          <div class="form-group">
            <label>Раса</label>
            <input type="text" id="charRace" class="form-control" placeholder="Человек">
          </div>
          <div class="form-group">
            <label>Подкласс</label>
            <input type="text" id="charSubclass" class="form-control" placeholder="Паладин">
          </div>
          <div class="form-group">
            <label>Уровень</label>
            <input type="number" id="charLevel" class="form-control" value="1" min="1" max="20" readonly>
          </div>
          <div class="form-group">
            <label>Опыт</label>
            <input type="number" id="charExp" class="form-control" value="0">
          </div>
          <div class="form-group">
            <label>Класс защиты</label>
            <input type="number" id="armorClass" class="form-control" value="10">
          </div>
          <div class="form-group shield-toggle">
            <label>
              <input type="checkbox" id="shieldToggle"> Щит
            </label>
            <input type="number" id="shieldBonus" class="form-control" value="2" min="0" max="5" style="width: 60px;">
          </div>
        </div>

        <!-- БЛОК ХИТОВ -->
        <div class="hp-section">
          <div class="form-group">
            <label>Текущие хиты</label>
            <input type="number" id="currentHP" class="form-control" value="10" min="0">
          </div>
          <div class="form-group">
            <label>Временные хиты</label>
            <input type="number" id="tempHP" class="form-control" value="0" min="0">
          </div>
          <div class="form-group">
            <label>Максимум хитов</label>
            <input type="number" id="maxHP" class="form-control" value="10" min="1">
          </div>
          <div class="form-group">
            <label>Кости хитов:</label>
            <div style="display: flex; gap: 0.5rem; align-items: center;">
              <select id="hitDiceType" class="form-control">
                <option value="d6">d6</option>
                <option value="d8">d8</option>
                <option value="d10" selected>d10</option>
                <option value="d12">d12</option>
              </select>
              <input type="number" id="hitDiceCount" class="form-control" value="1" min="0" style="width: 60px;">
            </div>
          </div>
          <div class="form-group">
            <label>Спасброски от смерти</label>
            <div class="death-saves">
              <div class="death-save-group">
                <label>Успехи</label>
                <div class="death-save-circles" id="successCircles">
                  <div class="death-save-circle" data-index="0"></div>
                  <div class="death-save-circle" data-index="1"></div>
                  <div class="death-save-circle" data-index="2"></div>
                </div>
              </div>
              <div class="death-save-group">
                <label>Провалы</label>
                <div class="death-save-circles" id="failureCircles">
                  <div class="death-save-circle" data-index="0"></div>
                  <div class="death-save-circle" data-index="1"></div>
                  <div class="death-save-circle" data-index="2"></div>
                </div>
              </div>
            </div>
            <button type="button" class="btn btn-secondary" id="rollDeathSave" style="margin-top: 0.5rem; width: 100%;">
              Бросок спасброска
            </button>
          </div>
        </div>

        <!-- ЛЕВАЯ КОЛОНКА - ХАРАКТЕРИСТИКИ -->
        <div class="ability-column">
          <div class="proficiency-bonus">
            Бонус владения: <span id="proficiencyBonus">+2</span>
          </div>

          <!-- Первая строка характеристик -->
          <div class="ability-row">
            <!-- Сила -->
            <div class="ability-card">
              <div class="ability-header">СИЛА</div>
              <input type="number" id="strScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="strMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="strSave"> Спасбросок</label>
                <span id="strSaveMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="athletics"> Атлетика</label>
                <span id="athleticsMod">+0</span>
              </div>
            </div>

            <!-- Ловкость -->
            <div class="ability-card">
              <div class="ability-header">ЛОВКОСТЬ</div>
              <input type="number" id="dexScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="dexMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="dexSave"> Спасбросок</label>
                <span id="dexSaveMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="acrobatics"> Акробатика</label>
                <span id="acrobaticsMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="sleight"> Ловкость рук</label>
                <span id="sleightMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="stealth"> Скрытность</label>
                <span id="stealthMod">+0</span>
              </div>
            </div>
          </div>

          <!-- Вторая строка характеристик -->
          <div class="ability-row">
            <!-- Телосложение -->
            <div class="ability-card">
              <div class="ability-header">ТЕЛОСЛОЖЕНИЕ</div>
              <input type="number" id="conScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="conMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="conSave"> Спасбросок</label>
                <span id="conSaveMod">+0</span>
              </div>
            </div>

            <!-- Интеллект -->
            <div class="ability-card">
              <div class="ability-header">ИНТЕЛЛЕКТ</div>
              <input type="number" id="intScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="intMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="intSave"> Спасбросок</label>
                <span id="intSaveMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="investigation"> Анализ</label>
                <span id="investigationMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="history"> История</label>
                <span id="historyMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="arcana"> Магия</label>
                <span id="arcanaMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="nature"> Природа</label>
                <span id="natureMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="religion"> Религия</label>
                <span id="religionMod">+0</span>
              </div>
            </div>
          </div>

          <!-- Третья строка характеристик -->
          <div class="ability-row">
            <!-- Мудрость -->
            <div class="ability-card">
              <div class="ability-header">МУДРОСТЬ</div>
              <input type="number" id="wisScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="wisMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="wisSave"> Спасбросок</label>
                <span id="wisSaveMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="perception"> Внимательность</label>
                <span id="perceptionMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="survival"> Выживание</label>
                <span id="survivalMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="medicine"> Медицина</label>
                <span id="medicineMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="insight"> Проницательность</label>
                <span id="insightMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="animal"> Уход за животными</label>
                <span id="animalMod">+0</span>
              </div>
            </div>

            <!-- Харизма -->
            <div class="ability-card">
              <div class="ability-header">ХАРИЗМА</div>
              <input type="number" id="chaScore" class="ability-score" value="10" min="1" max="30">
              <div class="ability-modifier" id="chaMod">+0</div>
              <div class="saving-throw">
                <label><input type="checkbox" id="chaSave"> Спасбросок</label>
                <span id="chaSaveMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="performance"> Выступление</label>
                <span id="performanceMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="intimidation"> Запугивание</label>
                <span id="intimidationMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="deception"> Обман</label>
                <span id="deceptionMod">+0</span>
              </div>
              <div class="skill">
                <label><input type="checkbox" id="persuasion"> Убеждение</label>
                <span id="persuasionMod">+0</span>
              </div>
            </div>
          </div>

          <!-- Инициатива и скорость -->
          <div class="ability-block">
            <div class="initiative-speed">
              <div class="stat-group">
                <div class="ability-header">ИНИЦИАТИВА</div>
                <div class="stat-value" id="initiativeValue">+0</div>
              </div>
              <div class="stat-group">
                <div class="ability-header">СКОРОСТЬ</div>
                <div class="stat-value">
                  <input type="number" id="speedValue" class="form-control" value="30" style="text-align: center;">
                </div>
              </div>
            </div>
            <div class="stat-group" style="margin-top: 1rem;">
              <div class="ability-header">ПАССИВНОЕ ВОСПРИЯТИЕ</div>
              <div class="stat-value" id="passivePerceptionValue">10</div>
            </div>
          </div>
        </div>

        <!-- ЦЕНТРАЛЬНАЯ КОЛОНКА -->
        <div class="center-column">
          <div class="ability-block">
            <div class="section-title">СОСТОЯНИЯ</div>
            <select id="conditions" class="conditions-select" multiple>
              <option value="blinded">Ослеплен</option>
              <option value="charmed">Очарован</option>
              <option value="deafened">Оглох</option>
              <option value="frightened">Испуган</option>
              <option value="grappled">Схвачен</option>
              <option value="incapacitated">Недееспособен</option>
              <option value="invisible">Невидим</option>
              <option value="paralyzed">Парализован</option>
              <option value="petrified">Окаменевший</option>
              <option value="poisoned">Отравлен</option>
              <option value="prone">Лежит</option>
              <option value="restrained">Скован</option>
              <option value="stunned">Ошеломлен</option>
              <option value="unconscious">Без сознания</option>
            </select>
          </div>

          <div class="ability-block">
            <div class="section-title">ОРУЖИЕ И БОЕВЫЕ ЗАГОВОРЫ</div>
            <table class="weapons-table">
              <thead>
                <tr>
                  <th>Название</th>
                  <th>Бонус / Сложность</th>
                  <th>Урон / Вид</th>
                  <th>Заметки</th>
                </tr>
              </thead>
              <tbody id="weaponsTableBody">
                <tr>
                  <td><input type="text" class="form-control" placeholder="Длинный меч"></td>
                  <td><input type="text" class="form-control" placeholder="+5"></td>
                  <td><input type="text" class="form-control" placeholder="1d8 рубящий"></td>
                  <td><input type="text" class="form-control" placeholder=""></td>
                </tr>
              </tbody>
            </table>
            <button type="button" class="btn btn-secondary" id="addWeapon" style="margin-top: 0.5rem; width: 100%;">
              + Добавить оружие
            </button>
          </div>

          <div class="ability-block">
            <div class="section-title">СПОСОБНОСТИ КЛАССА</div>
            <textarea id="classAbilities" class="text-area" placeholder="Способности класса..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">СПОСОБНОСТИ РАСЫ</div>
            <textarea id="raceAbilities" class="text-area" placeholder="Способности расы..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">ЧЕРТЫ</div>
            <textarea id="features" class="text-area" placeholder="Черты персонажа..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">ЗАМЕТКИ</div>
            <textarea id="notes" class="text-area" placeholder="Заметки..."></textarea>
          </div>
        </div>

        <!-- ПРАВАЯ КОЛОНКА -->
        <div class="right-column">
          <div class="ability-block">
            <div class="section-title">ВЛАДЕНИЕ СНАРЯЖЕНИЕМ</div>
            <div class="proficiencies-row">
              <div class="checkbox-group">
                <input type="checkbox" id="lightArmor">
                <label for="lightArmor">Лёгкие доспехи</label>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="mediumArmor">
                <label for="mediumArmor">Средние доспехи</label>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="heavyArmor">
                <label for="heavyArmor">Тяжёлые доспехи</label>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="shieldProficiency">
                <label for="shieldProficiency">Щиты</label>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="simpleWeapons">
                <label for="simpleWeapons">Простое оружие</label>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="martialWeapons">
                <label for="martialWeapons">Воинское оружие</label>
              </div>
            </div>
            
            <div style="margin-top: 1rem;">
              <div class="section-title">ИНСТРУМЕНТЫ И ЯЗЫКИ</div>
              <textarea id="toolProficiencies" class="text-area" placeholder="Инструменты и языки..."></textarea>
            </div>
          </div>

          <div class="ability-block">
            <div class="section-title">ПОРТРЕТ</div>
            <div class="portrait-section">
              <div class="portrait-placeholder" id="portraitPlaceholder">
                Нажмите для загрузки изображения
              </div>
              <img id="portraitPreview" class="portrait-preview" alt="Портрет персонажа">
              <input type="file" id="portraitUpload" accept="image/*" style="display: none;">
            </div>
          </div>

          <div class="ability-block">
            <div class="section-title">ЦЕЛИ И ЗАДАЧИ</div>
            <textarea id="goals" class="text-area" placeholder="Цели и задачи персонажа..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">ВНЕШНОСТЬ</div>
            <textarea id="appearance" class="text-area" placeholder="Описание внешности..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">ПРЕДЫСТОРИЯ</div>
            <textarea id="personality" class="text-area" placeholder="Личные качества и предыстория..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">СНАРЯЖЕНИЕ</div>
            <textarea id="equipment" class="text-area" placeholder="Снаряжение персонажа..."></textarea>
          </div>

          <div class="ability-block">
            <div class="section-title">МОНЕТЫ</div>
            <div class="coins-section">
              <div class="coin-group">
                <label>ММ</label>
                <input type="number" id="cp" class="form-control" value="0" min="0">
              </div>
              <div class="coin-group">
                <label>СМ</label>
                <input type="number" id="sp" class="form-control" value="0" min="0">
              </div>
              <div class="coin-group">
                <label>ЗМ</label>
                <input type="number" id="gp" class="form-control" value="0" min="0">
              </div>
              <div class="coin-group">
                <label>ЭМ</label>
                <input type="number" id="ep" class="form-control" value="0" min="0">
              </div>
              <div class="coin-group">
                <label>ПМ</label>
                <input type="number" id="pp" class="form-control" value="0" min="0">
              </div>
            </div>
            <div class="coin-calculator">
              <button class="btn btn-secondary" id="calculateCoins" style="width: 100%;">Рассчитать общую сумму</button>
              <div id="coinTotal" style="text-align: center; margin-top: 0.5rem; font-weight: bold;"></div>
            </div>
          </div>
        </div>

        <!-- КНИГА ЗАКЛИНАНИЙ -->
        <div class="spellbook-section">
          <div class="ability-block">
            <div class="section-title">КНИГА ЗАКЛИНАНИЙ</div>
            
            <div class="spell-levels">
              <div class="spell-level active" data-level="0">Заговоры</div>
              <div class="spell-level" data-level="1">1 уровень</div>
              <div class="spell-level" data-level="2">2 уровень</div>
              <div class="spell-level" data-level="3">3 уровень</div>
              <div class="spell-level" data-level="4">4 уровень</div>
              <div class="spell-level" data-level="5">5 уровень</div>
              <div class="spell-level" data-level="6">6 уровень</div>
              <div class="spell-level" data-level="7">7 уровень</div>
              <div class="spell-level" data-level="8">8 уровень</div>
              <div class="spell-level" data-level="9">9 уровень</div>
            </div>

            <div class="spell-slots">
              <div class="spell-slot">
                <label>Ячейки заклинаний</label>
                <input type="number" class="form-control" value="0" min="0">
              </div>
              <div class="spell-slot">
                <label>Использовано</label>
                <input type="number" class="form-control" value="0" min="0">
              </div>
            </div>

            <div class="spell-list">
              <div class="spell-item">
                <strong>Огненный шар</strong> - 3 уровень, evocation
              </div>
              <div class="spell-item">
                <strong>Лечение ран</strong> - 1 уровень, evocation
              </div>
              <div class="spell-item">
                <strong>Волшебная стрела</strong> - 1 уровень, evocation
              </div>
            </div>

            <textarea id="spellbook" class="text-area" placeholder="Описание заклинаний..." style="min-height: 200px; margin-top: 1rem;"></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="characters.js"></script>
</body>
</html>

